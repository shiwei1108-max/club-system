generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// 1. 使用者
model User {
  id       Int          @id @default(autoincrement())
  email    String       @unique
  password String
  name     String?
  members  ClubMember[] // 連結到成員表
}

// 2. 舞碼群組 (原社團)
model Club {
  id          Int          @id @default(autoincrement())
  name        String
  description String?      // [新增] 介紹
  location    String?      // [新增] 排練地點
  members     ClubMember[] // 連結到成員表
  activities  Activity[]   // 連結到日程表
}

// 3. ★ 成員名單 (剛剛缺少的關鍵部分) ★
model ClubMember {
  id      Int    @id @default(autoincrement())
  
  user    User   @relation(fields: [userId], references: [id])
  userId  Int
  
  club    Club   @relation(fields: [clubId], references: [id])
  clubId  Int
  
  role    String @default("member") // admin 或 member
}

// 4. 排練/演出日程 (原活動)
model Activity {
  id        Int       @id @default(autoincrement())
  title     String
  date      String
  content   String?
  type      String?   // [新增] 類型: rehearsal, show
  
  club      Club      @relation(fields: [clubId], references: [id])
  clubId    Int
  
  expenses  Expense[] // 連結到經費表
}

// 5. 經費/預算
model Expense {
  id         Int      @id @default(autoincrement())
  item       String
  amount     Int
  status     String   @default("pending")
  
  activity   Activity @relation(fields: [activityId], references: [id])
  activityId Int
}